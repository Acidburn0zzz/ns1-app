{"version":3,"sources":["../../../src/components/snaptask/snaptask_list.js"],"names":[],"mappings":";;;;;;;;;;;;;AACA,WAAS,OAAT,CAAiB,GAAjB,EAAsB;AACrB,QAAI,OAAO,IAAI,OAAJ,CAAY,GAAZ,EAAiB,IAAjB,EAAuB,OAAvB,CAA+B,GAA/B,EAAoC,KAApC,EAA2C,OAA3C,CAAmD,GAAnD,EAAwD,GAAxD,EAA6D,OAA7D,CAAqE,OAArE,EAA8E,EAA9E,CAAX;AACA,WAAO,IAAP;AACA;;;;;;;;;;;;;;;;;;;;;;;kCAEK,gB;AACJ,kCAAY,MAAZ,EAAoB,SAApB,EAA+B,UAA/B,EAA2C,QAA3C,EAAqD;AAAA;;AACpD,eAAK,UAAL,GAAkB,UAAlB;AACC,eAAK,QAAL,GAAgB,QAAhB;AACA,eAAK,SAAL,GAAiB,KAAjB;AACA,eAAK,KAAL,GAAa,EAAb;;AAEA,eAAK,QAAL;AACD;;;;qCAEU;AACT,gBAAI,OAAO,IAAX;AACA,mBAAO,KAAK,UAAL,CAAgB,GAAhB,CAAoB,gCAApB,EAAsD,EAAC,QAAQ,sBAAT,EAAtD,EACN,IADM,CACD,UAAC,IAAD,EAAU;AACd,mBAAK,KAAL,GAAa,KAAK,IAAlB;AACH,mBAAK,SAAL,GAAiB,IAAjB;AACE,aAJM,CAAP;AAKD;;;qCAEU,I,EAAM;AAChB,gBAAI,OAAO,IAAX;AACC,mBAAO,KAAK,UAAL,CAAgB,MAAhB,CAAuB,oCAAkC,KAAK,EAA9D,EAAkE,IAAlE,CAAuE,UAAC,IAAD,EAAU;AACtF,kBAAI,KAAK,IAAL,CAAU,IAAV,KAAmB,GAAvB,EAA4B;AAC1B,qBAAK,QAAL,CAAc,GAAd,CAAkB,uBAAlB,EAA2C,IAA3C,EAAiD,OAAjD,EAA0D,KAA1D;AACD;AACD,mBAAK,QAAL;AACD,aALM,CAAP;AAMD;;;mCAEQ,I,EAAM;AACd,iBAAK,OAAL,GAAe,KAAf;AACC,mBAAO,KAAK,UAAL,CAAgB,GAAhB,CAAoB,gCAApB,EAAsD,IAAtD,CAAP;AACD;;;oCACS,I,EAAM;AACf,iBAAK,OAAL,GAAe,IAAf;AACC,mBAAO,KAAK,UAAL,CAAgB,GAAhB,CAAoB,gCAApB,EAAsD,IAAtD,CAAP;AACD;;;kCAEO,I,EAAM;AACb,gBAAI,KAAK,IAAL,CAAU,SAAV,CAAoB,CAApB,EAAsB,EAAtB,MAA8B,gBAAlC,EAAoD;AACnD,qBAAO,eAAP;AACA;AACF,gBAAI,KAAK,IAAL,CAAU,SAAV,CAAoB,CAApB,EAAsB,CAAtB,MAA6B,UAAjC,EAA6C;AAC3C,qBAAO,MAAP;AACA;AACD,mBAAO,EAAP;AACA;;;wCAEa,I,EAAM;AACnB,gBAAI,OAAM,KAAK,OAAL,CAAa,IAAb,CAAV;AACA,gBAAK,SAAS,eAAd,EAA+B;AAC9B,qBAAO,4CAA4C,QAAQ,KAAK,MAAL,CAAY,oBAAZ,EAAkC,OAA1C,CAAnD;AACA,aAFD,MAEO,IAAI,QAAQ,MAAZ,EAAoB;AAC1B,qBAAO,sCAAsC,QAAQ,KAAK,MAAL,CAAY,oBAAZ,EAAkC,IAA1C,CAA7C;AACA;AACD;;;oCAES,I,EAAM;AACf,gBAAI,OAAM,KAAK,OAAL,CAAa,IAAb,CAAV;AACA,gBAAK,SAAS,eAAd,EAA+B;AAC9B,qBAAO,qBAAoB,KAAK,MAAL,CAAY,oBAAZ,EAAkC,OAA7D;AACA,aAFD,MAEO,IAAI,QAAQ,MAAZ,EAAoB;AAC1B,qBAAO,WAAU,KAAK,MAAL,CAAY,oBAAZ,EAAkC,IAAnD;AACA;AACD;;;;;;AAGH,uBAAiB,WAAjB,GAA+B,wEAA/B;;kCACQ,gB","file":"snaptask_list.js","sourcesContent":["\nfunction slugify(str) {\n\tvar slug = str.replace(\"@\", \"at\").replace(\"&\", \"and\").replace(\".\", \"_\").replace(\"/\\W+/\", \"\");\n\treturn slug;\n}\n\nclass SnapTaskListCtrl {\n  constructor($scope, $injector, backendSrv, alertSrv) {\n  \tthis.backendSrv = backendSrv;\n    this.alertSrv = alertSrv;\n    this.pageReady = false;\n    this.tasks = [];\n\n    this.getTasks();\n  }\n\n  getTasks() {\n    var self = this;\n    return this.backendSrv.get(\"api/plugin-proxy/ns1-app/tasks\", {metric: \"/raintank/apps/ns1/*\"})\n    .then((resp) => {\n      self.tasks = resp.body;\n\t\t\tself.pageReady = true;\n    });\n  }\n\n  removeTask(task) {\n  \tvar self = this;\n    return this.backendSrv.delete(\"api/plugin-proxy/ns1-app/tasks/\"+task.id).then((resp) => {\n      if (resp.meta.code !== 200) {\n        self.alertSrv.set(\"failed to delete task\", resp, 'error', 10000);\n      }\n      self.getTasks();\n    });\n  }\n\n  stopTask(task) {\n  \ttask.enabled = false;\n    return this.backendSrv.put(\"api/plugin-proxy/ns1-app/tasks\", task);\n  }\n  startTask(task) {\n  \ttask.enabled = true;\n    return this.backendSrv.put(\"api/plugin-proxy/ns1-app/tasks\", task);\n  }\n\n  getType(task) {\n  \tif (task.name.substring(0,14) === \"ns1-monitoring\") {\n  \t\treturn \"monitoringJob\";\n  \t}\n\t\tif (task.name.substring(0,8) === \"ns1-zone\") {\n  \t\treturn \"zone\";\n  \t}\n  \treturn \"\";\n  }\n\n  taskDashboard(task) {\n  \tvar type =this.getType(task)\n  \tif ( type === \"monitoringJob\") {\n  \t\treturn \"dashboard/db/ns1-monitors?&var-monitor=\" + slugify(task.config['/raintank/apps/ns1'].jobName);\n  \t} else if (type == \"zone\") {\n  \t\treturn \"dashboard/db/ns1-zones?&var-zone=\" + slugify(task.config['/raintank/apps/ns1'].zone);\n  \t}\n  }\n\n  taskLabel(task) {\n  \tvar type =this.getType(task)\n  \tif ( type === \"monitoringJob\") {\n  \t\treturn \"Monitoring Job: \"+ task.config['/raintank/apps/ns1'].jobName;\n  \t} else if (type == \"zone\") {\n  \t\treturn \"Zone: \"+ task.config['/raintank/apps/ns1'].zone;\n  \t}\n  }\n}\n\nSnapTaskListCtrl.templateUrl = 'public/plugins/ns1-app/components/snaptask/partials/snaptask_list.html';\nexport {SnapTaskListCtrl};\n"]}